
> fsm-as-promised@0.13.1 test /Users/vlad/Dropbox/Projects/github/fsm-as-promised
> mocha



  Promise library: Default
    Initialisation
      ✓ should default to "none" state
      ✓ should initialize to provided state
      ✓ should throw error on transition with array value for 'to'
      ✓ should use the configured promise library
    Basic operations
0 undefined
0 false
0 false
0 false
      ✓ should load standalone state machine
0 undefined
0 false
0 false
0 false
      ✓ should load targeted state machine
0 undefined
      ✓ should access targeted state machine properties
0 undefined
0 false
      ✓ should indicate if can transition - can & cannot
0 undefined
0 false
      ✓ should find if state is the current state - is
0 undefined
0 false
      ✓ should throw errors on inapropriate events
0 undefined
      ✓ should call callbacks in proper order during transition events
      ✓ should call callbacks in proper order during no-transition events
0 undefined
      ✓ should call callbacks with correct arguments
0 undefined
      ✓ should call with correct arguments when sync callbacks return undefined
0 undefined
      ✓ should call with correct arguments when async callbacks return undefined
0 undefined
      ✓ should call sync callback
0 undefined
      ✓ should call async callback
0 undefined
      ✓ should call mixed sync & async callbacks
0 undefined
      ✓ should support arrow functions as callbacks
    Advanced operations
0 undefined
      ✓ should trigger event with multiple "from" states for same event
      ✓ should trigger event with multiple "from" states but no "to"
0 undefined
0 false
0 false
0 false
      ✓ should trigger event with multiple "to" states for same event
      ✓ should trigger multiple times events with no state transition
0 undefined
0 false
0 false
0 false
      ✓ should trigger appropriately with multiple "from" and "to" transitions
0 undefined
0 false
0 false
      ✓ should support spying (85ms)
    Transitions
0 undefined
      ✓ should allow inter transition
      ✓ should allow nop transition
      ✓ should allow multiple nop transitions
0 undefined
      ✓ should throw error on nop when previous inter transition not completed
0 undefined
0 true
      ✓ should throw error on inter when previous inter transition not completed
1 undefined
      ✓ should throw error on inter when previous nop transition not completed
0 undefined
0 false
      ✓ should clean up failed inter transition
0 undefined
      ✓ should clean up failed noop transition
0 undefined
0 false
      ✓ should trigger new transition immediately when entered a state
0 undefined
      ✓ should trigger inter state transition after specific no-transition event
    Graceful error recovery
0 undefined
      ✓ should recover from error in sync callback and continue transition
0 undefined
      ✓ should recover from error in async callback and continue transition
    Transition lifecycle with errors
0 undefined
      ✓ should remain in "from" state when error in onleave{stateName}
0 undefined
      ✓ should remain in "from" state when error in onleave
0 undefined
      ✓ should revert to "from" state when error in on{eventName}
0 undefined
      ✓ should revert to "from" state when error in onenter{stateName}
0 undefined
      ✓ should revert to "from" state when error in onenter
0 undefined
      ✓ should move to "to" state when error in onentered{stateName}
0 undefined
      ✓ should move to "to" state when error in onentered
    Promise chain returned values
0 undefined
      ✓ should return "options" if not set
0 undefined
      ✓ should return object if "options.res" set in a callback
0 undefined
      ✓ should return last object if "options.res" set in multiple callbacks
0 undefined
      ✓ should return properties of "options" set in callbacks
0 undefined
      ✓ should return last property of "options" value updated in callbacks
    Conditional transition
      ✓ should initialize state machine
0 undefined
0 false
      ✓ should transition async to selected choice
0 undefined
0 false
      ✓ should transition from multiple states
0 undefined
0 false
      ✓ should receive original options object
0 undefined
0 false
      ✓ should receive response set in choice transition callback
0 undefined
0 false
0 false
0 false
      ✓ should clear response cache before run
0 undefined
0 false
      ✓ should throw error when out of choice index
      when the condition callback returns a numeric index
0 undefined
0 false
        ✓ should transition to first choice
0 undefined
0 false
        ✓ should transition to second choice
      when the condition callback returns a state name
0 undefined
0 false
        ✓ should transition to first choice
0 undefined
0 false
        ✓ should transition to second choice
    isFinal
      single final state
0 undefined
        ✓ should report if current state is final
        ✓ should report if provided state is final
      multiple final states
0 undefined
        ✓ should report if current state is final
        ✓ should report if provided state is final
    Callback prefix: 
0 undefined
      ✓ should call callbacks with custom prefix
0 undefined
      ✓ should call callbacks with no prefix

  Promise library: bluebird
    Initialisation
      ✓ should default to "none" state
      ✓ should initialize to provided state
      ✓ should throw error on transition with array value for 'to'
      ✓ should use the configured promise library
    Basic operations
0 undefined
0 false
0 false
0 false
      ✓ should load standalone state machine
0 undefined
0 false
0 false
0 false
      ✓ should load targeted state machine
0 undefined
      ✓ should access targeted state machine properties
0 undefined
0 false
      ✓ should indicate if can transition - can & cannot
0 undefined
0 false
      ✓ should find if state is the current state - is
0 undefined
0 false
      ✓ should throw errors on inapropriate events
0 undefined
      ✓ should call callbacks in proper order during transition events
      ✓ should call callbacks in proper order during no-transition events
0 undefined
      ✓ should call callbacks with correct arguments
0 undefined
      ✓ should call with correct arguments when sync callbacks return undefined
0 undefined
      ✓ should call with correct arguments when async callbacks return undefined
0 undefined
      ✓ should call sync callback
0 undefined
      ✓ should call async callback
0 undefined
      ✓ should call mixed sync & async callbacks
0 undefined
      ✓ should support arrow functions as callbacks
    Advanced operations
0 undefined
      ✓ should trigger event with multiple "from" states for same event
      ✓ should trigger event with multiple "from" states but no "to"
0 undefined
0 false
0 false
0 false
      ✓ should trigger event with multiple "to" states for same event
      ✓ should trigger multiple times events with no state transition
0 undefined
0 false
0 false
0 false
      ✓ should trigger appropriately with multiple "from" and "to" transitions
0 undefined
0 false
0 false
      ✓ should support spying
    Transitions
0 undefined
      ✓ should allow inter transition
      ✓ should allow nop transition
      ✓ should allow multiple nop transitions
0 undefined
      ✓ should throw error on nop when previous inter transition not completed
0 undefined
0 true
      ✓ should throw error on inter when previous inter transition not completed
1 undefined
      ✓ should throw error on inter when previous nop transition not completed
0 undefined
0 false
      ✓ should clean up failed inter transition
0 undefined
      ✓ should clean up failed noop transition
0 undefined
0 false
      ✓ should trigger new transition immediately when entered a state
0 undefined
      ✓ should trigger inter state transition after specific no-transition event
    Graceful error recovery
0 undefined
      ✓ should recover from error in sync callback and continue transition
0 undefined
      ✓ should recover from error in async callback and continue transition
    Transition lifecycle with errors
0 undefined
      ✓ should remain in "from" state when error in onleave{stateName}
0 undefined
      ✓ should remain in "from" state when error in onleave
0 undefined
      ✓ should revert to "from" state when error in on{eventName}
0 undefined
      ✓ should revert to "from" state when error in onenter{stateName}
0 undefined
      ✓ should revert to "from" state when error in onenter
0 undefined
      ✓ should move to "to" state when error in onentered{stateName}
0 undefined
      ✓ should move to "to" state when error in onentered
    Promise chain returned values
0 undefined
      ✓ should return "options" if not set
0 undefined
      ✓ should return object if "options.res" set in a callback
0 undefined
      ✓ should return last object if "options.res" set in multiple callbacks
0 undefined
      ✓ should return properties of "options" set in callbacks
0 undefined
      ✓ should return last property of "options" value updated in callbacks
    Conditional transition
      ✓ should initialize state machine
0 undefined
0 false
      ✓ should transition async to selected choice
0 undefined
0 false
      ✓ should transition from multiple states
0 undefined
0 false
      ✓ should receive original options object
0 undefined
0 false
      ✓ should receive response set in choice transition callback
0 undefined
0 false
0 false
0 false
      ✓ should clear response cache before run
0 undefined
0 false
      ✓ should throw error when out of choice index
      when the condition callback returns a numeric index
0 undefined
0 false
        ✓ should transition to first choice
0 undefined
0 false
        ✓ should transition to second choice
      when the condition callback returns a state name
0 undefined
0 false
        ✓ should transition to first choice
0 undefined
0 false
        ✓ should transition to second choice
    isFinal
      single final state
0 undefined
        ✓ should report if current state is final
        ✓ should report if provided state is final
      multiple final states
0 undefined
        ✓ should report if current state is final
        ✓ should report if provided state is final
    Callback prefix: 
0 undefined
      ✓ should call callbacks with custom prefix
0 undefined
      ✓ should call callbacks with no prefix

  Promise library: ES6Shim
    Initialisation
      ✓ should default to "none" state
      ✓ should initialize to provided state
      ✓ should throw error on transition with array value for 'to'
      ✓ should use the configured promise library
    Basic operations
0 undefined
0 false
0 false
0 false
      ✓ should load standalone state machine
0 undefined
0 false
0 false
0 false
      ✓ should load targeted state machine
0 undefined
      ✓ should access targeted state machine properties
0 undefined
0 false
      ✓ should indicate if can transition - can & cannot
0 undefined
0 false
      ✓ should find if state is the current state - is
0 undefined
0 false
      ✓ should throw errors on inapropriate events
0 undefined
      ✓ should call callbacks in proper order during transition events
      ✓ should call callbacks in proper order during no-transition events
0 undefined
      ✓ should call callbacks with correct arguments
0 undefined
      ✓ should call with correct arguments when sync callbacks return undefined
0 undefined
      ✓ should call with correct arguments when async callbacks return undefined
0 undefined
      ✓ should call sync callback
0 undefined
      ✓ should call async callback
0 undefined
      ✓ should call mixed sync & async callbacks
0 undefined
      ✓ should support arrow functions as callbacks
    Advanced operations
0 undefined
      ✓ should trigger event with multiple "from" states for same event
      ✓ should trigger event with multiple "from" states but no "to"
0 undefined
0 false
0 false
0 false
      ✓ should trigger event with multiple "to" states for same event
      ✓ should trigger multiple times events with no state transition
0 undefined
0 false
0 false
0 false
      ✓ should trigger appropriately with multiple "from" and "to" transitions
0 undefined
0 false
0 false
      ✓ should support spying
    Transitions
0 undefined
      ✓ should allow inter transition
      ✓ should allow nop transition
      ✓ should allow multiple nop transitions
0 undefined
      ✓ should throw error on nop when previous inter transition not completed
0 undefined
0 true
      ✓ should throw error on inter when previous inter transition not completed
1 undefined
      ✓ should throw error on inter when previous nop transition not completed
0 undefined
0 false
      ✓ should clean up failed inter transition
0 undefined
      ✓ should clean up failed noop transition
0 undefined
0 false
      ✓ should trigger new transition immediately when entered a state
0 undefined
      ✓ should trigger inter state transition after specific no-transition event
    Graceful error recovery
0 undefined
      ✓ should recover from error in sync callback and continue transition
0 undefined
      ✓ should recover from error in async callback and continue transition
    Transition lifecycle with errors
0 undefined
      ✓ should remain in "from" state when error in onleave{stateName}
0 undefined
      ✓ should remain in "from" state when error in onleave
0 undefined
      ✓ should revert to "from" state when error in on{eventName}
0 undefined
      ✓ should revert to "from" state when error in onenter{stateName}
0 undefined
      ✓ should revert to "from" state when error in onenter
0 undefined
      ✓ should move to "to" state when error in onentered{stateName}
0 undefined
      ✓ should move to "to" state when error in onentered
    Promise chain returned values
0 undefined
      ✓ should return "options" if not set
0 undefined
      ✓ should return object if "options.res" set in a callback
0 undefined
      ✓ should return last object if "options.res" set in multiple callbacks
0 undefined
      ✓ should return properties of "options" set in callbacks
0 undefined
      ✓ should return last property of "options" value updated in callbacks
    Conditional transition
      ✓ should initialize state machine
0 undefined
0 false
      ✓ should transition async to selected choice
0 undefined
0 false
      ✓ should transition from multiple states
0 undefined
0 false
      ✓ should receive original options object
0 undefined
0 false
      ✓ should receive response set in choice transition callback
0 undefined
0 false
0 false
0 false
      ✓ should clear response cache before run
0 undefined
0 false
      ✓ should throw error when out of choice index
      when the condition callback returns a numeric index
0 undefined
0 false
        ✓ should transition to first choice
0 undefined
0 false
        ✓ should transition to second choice
      when the condition callback returns a state name
0 undefined
0 false
        ✓ should transition to first choice
0 undefined
0 false
        ✓ should transition to second choice
    isFinal
      single final state
0 undefined
        ✓ should report if current state is final
        ✓ should report if provided state is final
      multiple final states
0 undefined
        ✓ should report if current state is final
        ✓ should report if provided state is final
    Callback prefix: 
0 undefined
      ✓ should call callbacks with custom prefix
0 undefined
      ✓ should call callbacks with no prefix

  Promise library: lie
    Initialisation
      ✓ should default to "none" state
      ✓ should initialize to provided state
      ✓ should throw error on transition with array value for 'to'
      ✓ should use the configured promise library
    Basic operations
0 undefined
0 false
0 false
0 false
      ✓ should load standalone state machine
0 undefined
0 false
0 false
0 false
      ✓ should load targeted state machine
0 undefined
      ✓ should access targeted state machine properties
0 undefined
0 false
      ✓ should indicate if can transition - can & cannot
0 undefined
0 false
      ✓ should find if state is the current state - is
0 undefined
0 false
      ✓ should throw errors on inapropriate events
0 undefined
      ✓ should call callbacks in proper order during transition events
      ✓ should call callbacks in proper order during no-transition events
0 undefined
      ✓ should call callbacks with correct arguments
0 undefined
      ✓ should call with correct arguments when sync callbacks return undefined
0 undefined
      ✓ should call with correct arguments when async callbacks return undefined
0 undefined
      ✓ should call sync callback
0 undefined
      ✓ should call async callback
0 undefined
      ✓ should call mixed sync & async callbacks
0 undefined
      ✓ should support arrow functions as callbacks
    Advanced operations
0 undefined
      ✓ should trigger event with multiple "from" states for same event
      ✓ should trigger event with multiple "from" states but no "to"
0 undefined
0 false
0 false
0 false
      ✓ should trigger event with multiple "to" states for same event
      ✓ should trigger multiple times events with no state transition
0 undefined
0 false
0 false
0 false
      ✓ should trigger appropriately with multiple "from" and "to" transitions
0 undefined
0 false
0 false
      ✓ should support spying
    Transitions
0 undefined
      ✓ should allow inter transition
      ✓ should allow nop transition
      ✓ should allow multiple nop transitions
0 undefined
      ✓ should throw error on nop when previous inter transition not completed
0 undefined
0 true
      ✓ should throw error on inter when previous inter transition not completed
1 undefined
      ✓ should throw error on inter when previous nop transition not completed
0 undefined
0 false
      ✓ should clean up failed inter transition
0 undefined
      ✓ should clean up failed noop transition
0 undefined
0 false
      ✓ should trigger new transition immediately when entered a state
0 undefined
      ✓ should trigger inter state transition after specific no-transition event
    Graceful error recovery
0 undefined
      ✓ should recover from error in sync callback and continue transition
0 undefined
      ✓ should recover from error in async callback and continue transition
    Transition lifecycle with errors
0 undefined
      ✓ should remain in "from" state when error in onleave{stateName}
0 undefined
      ✓ should remain in "from" state when error in onleave
0 undefined
      ✓ should revert to "from" state when error in on{eventName}
0 undefined
      ✓ should revert to "from" state when error in onenter{stateName}
0 undefined
      ✓ should revert to "from" state when error in onenter
0 undefined
      ✓ should move to "to" state when error in onentered{stateName}
0 undefined
      ✓ should move to "to" state when error in onentered
    Promise chain returned values
0 undefined
      ✓ should return "options" if not set
0 undefined
      ✓ should return object if "options.res" set in a callback
0 undefined
      ✓ should return last object if "options.res" set in multiple callbacks
0 undefined
      ✓ should return properties of "options" set in callbacks
0 undefined
      ✓ should return last property of "options" value updated in callbacks
    Conditional transition
      ✓ should initialize state machine
0 undefined
0 false
      ✓ should transition async to selected choice
0 undefined
0 false
      ✓ should transition from multiple states
0 undefined
0 false
      ✓ should receive original options object
0 undefined
0 false
      ✓ should receive response set in choice transition callback
0 undefined
0 false
0 false
0 false
      ✓ should clear response cache before run
0 undefined
0 false
      ✓ should throw error when out of choice index
      when the condition callback returns a numeric index
0 undefined
0 false
        ✓ should transition to first choice
0 undefined
0 false
        ✓ should transition to second choice
      when the condition callback returns a state name
0 undefined
0 false
        ✓ should transition to first choice
0 undefined
0 false
        ✓ should transition to second choice
    isFinal
      single final state
0 undefined
        ✓ should report if current state is final
        ✓ should report if provided state is final
      multiple final states
0 undefined
        ✓ should report if current state is final
        ✓ should report if provided state is final
    Callback prefix: 
0 undefined
      ✓ should call callbacks with custom prefix
0 undefined
      ✓ should call callbacks with no prefix

  Promise library: npo
    Initialisation
      ✓ should default to "none" state
      ✓ should initialize to provided state
      ✓ should throw error on transition with array value for 'to'
      ✓ should use the configured promise library
    Basic operations
0 undefined
0 false
0 false
0 false
      ✓ should load standalone state machine
0 undefined
0 false
0 false
0 false
      ✓ should load targeted state machine
0 undefined
      ✓ should access targeted state machine properties
0 undefined
0 false
      ✓ should indicate if can transition - can & cannot
0 undefined
0 false
      ✓ should find if state is the current state - is
0 undefined
0 false
      ✓ should throw errors on inapropriate events
0 undefined
      ✓ should call callbacks in proper order during transition events
      ✓ should call callbacks in proper order during no-transition events
0 undefined
      ✓ should call callbacks with correct arguments
0 undefined
      ✓ should call with correct arguments when sync callbacks return undefined
0 undefined
      ✓ should call with correct arguments when async callbacks return undefined
0 undefined
      ✓ should call sync callback
0 undefined
      ✓ should call async callback
0 undefined
      ✓ should call mixed sync & async callbacks
0 undefined
      ✓ should support arrow functions as callbacks
    Advanced operations
0 undefined
      ✓ should trigger event with multiple "from" states for same event
      ✓ should trigger event with multiple "from" states but no "to"
0 undefined
0 false
0 false
0 false
      ✓ should trigger event with multiple "to" states for same event
      ✓ should trigger multiple times events with no state transition
0 undefined
0 false
0 false
0 false
      ✓ should trigger appropriately with multiple "from" and "to" transitions
0 undefined
0 false
0 false
      ✓ should support spying
    Transitions
0 undefined
      ✓ should allow inter transition
      ✓ should allow nop transition
      ✓ should allow multiple nop transitions
0 undefined
      ✓ should throw error on nop when previous inter transition not completed
0 undefined
0 true
      ✓ should throw error on inter when previous inter transition not completed
1 undefined
      ✓ should throw error on inter when previous nop transition not completed
0 undefined
0 false
      ✓ should clean up failed inter transition
0 undefined
      ✓ should clean up failed noop transition
0 undefined
0 false
      ✓ should trigger new transition immediately when entered a state
0 undefined
      ✓ should trigger inter state transition after specific no-transition event
    Graceful error recovery
0 undefined
      ✓ should recover from error in sync callback and continue transition
0 undefined
      ✓ should recover from error in async callback and continue transition
    Transition lifecycle with errors
0 undefined
      ✓ should remain in "from" state when error in onleave{stateName}
0 undefined
      ✓ should remain in "from" state when error in onleave
0 undefined
      ✓ should revert to "from" state when error in on{eventName}
0 undefined
      ✓ should revert to "from" state when error in onenter{stateName}
0 undefined
      ✓ should revert to "from" state when error in onenter
0 undefined
      ✓ should move to "to" state when error in onentered{stateName}
0 undefined
      ✓ should move to "to" state when error in onentered
    Promise chain returned values
0 undefined
      ✓ should return "options" if not set
0 undefined
      ✓ should return object if "options.res" set in a callback
0 undefined
      ✓ should return last object if "options.res" set in multiple callbacks
0 undefined
      ✓ should return properties of "options" set in callbacks
0 undefined
      ✓ should return last property of "options" value updated in callbacks
    Conditional transition
      ✓ should initialize state machine
0 undefined
0 false
      ✓ should transition async to selected choice
0 undefined
0 false
      ✓ should transition from multiple states
0 undefined
0 false
      ✓ should receive original options object
0 undefined
0 false
      ✓ should receive response set in choice transition callback
0 undefined
0 false
0 false
0 false
      ✓ should clear response cache before run
0 undefined
0 false
      ✓ should throw error when out of choice index
      when the condition callback returns a numeric index
0 undefined
0 false
        ✓ should transition to first choice
0 undefined
0 false
        ✓ should transition to second choice
      when the condition callback returns a state name
0 undefined
0 false
        ✓ should transition to first choice
0 undefined
0 false
        ✓ should transition to second choice
    isFinal
      single final state
0 undefined
        ✓ should report if current state is final
        ✓ should report if provided state is final
      multiple final states
0 undefined
        ✓ should report if current state is final
        ✓ should report if provided state is final
    Callback prefix: 
0 undefined
      ✓ should call callbacks with custom prefix
0 undefined
      ✓ should call callbacks with no prefix

  Promise library: pinkie
    Initialisation
      ✓ should default to "none" state
      ✓ should initialize to provided state
      ✓ should throw error on transition with array value for 'to'
      ✓ should use the configured promise library
    Basic operations
0 undefined
0 false
0 false
0 false
      ✓ should load standalone state machine
0 undefined
0 false
0 false
0 false
      ✓ should load targeted state machine
0 undefined
      ✓ should access targeted state machine properties
0 undefined
0 false
      ✓ should indicate if can transition - can & cannot
0 undefined
0 false
      ✓ should find if state is the current state - is
0 undefined
0 false
      ✓ should throw errors on inapropriate events
0 undefined
      ✓ should call callbacks in proper order during transition events
      ✓ should call callbacks in proper order during no-transition events
0 undefined
      ✓ should call callbacks with correct arguments
0 undefined
      ✓ should call with correct arguments when sync callbacks return undefined
0 undefined
      ✓ should call with correct arguments when async callbacks return undefined
0 undefined
      ✓ should call sync callback
0 undefined
      ✓ should call async callback
0 undefined
      ✓ should call mixed sync & async callbacks
0 undefined
      ✓ should support arrow functions as callbacks
    Advanced operations
0 undefined
      ✓ should trigger event with multiple "from" states for same event
      ✓ should trigger event with multiple "from" states but no "to"
0 undefined
0 false
0 false
0 false
      ✓ should trigger event with multiple "to" states for same event
      ✓ should trigger multiple times events with no state transition
0 undefined
0 false
0 false
0 false
      ✓ should trigger appropriately with multiple "from" and "to" transitions
0 undefined
0 false
0 false
      ✓ should support spying
    Transitions
0 undefined
      ✓ should allow inter transition
      ✓ should allow nop transition
      ✓ should allow multiple nop transitions
0 undefined
      ✓ should throw error on nop when previous inter transition not completed
0 undefined
0 true
      ✓ should throw error on inter when previous inter transition not completed
1 undefined
      ✓ should throw error on inter when previous nop transition not completed
0 undefined
0 false
      ✓ should clean up failed inter transition
0 undefined
      ✓ should clean up failed noop transition
0 undefined
0 false
      ✓ should trigger new transition immediately when entered a state
0 undefined
      ✓ should trigger inter state transition after specific no-transition event
    Graceful error recovery
0 undefined
      ✓ should recover from error in sync callback and continue transition
0 undefined
      ✓ should recover from error in async callback and continue transition
    Transition lifecycle with errors
0 undefined
      ✓ should remain in "from" state when error in onleave{stateName}
0 undefined
      ✓ should remain in "from" state when error in onleave
0 undefined
      ✓ should revert to "from" state when error in on{eventName}
0 undefined
      ✓ should revert to "from" state when error in onenter{stateName}
0 undefined
      ✓ should revert to "from" state when error in onenter
0 undefined
      ✓ should move to "to" state when error in onentered{stateName}
0 undefined
      ✓ should move to "to" state when error in onentered
    Promise chain returned values
0 undefined
      ✓ should return "options" if not set
0 undefined
      ✓ should return object if "options.res" set in a callback
0 undefined
      ✓ should return last object if "options.res" set in multiple callbacks
0 undefined
      ✓ should return properties of "options" set in callbacks
0 undefined
      ✓ should return last property of "options" value updated in callbacks
    Conditional transition
      ✓ should initialize state machine
0 undefined
0 false
      ✓ should transition async to selected choice
0 undefined
0 false
      ✓ should transition from multiple states
0 undefined
0 false
      ✓ should receive original options object
0 undefined
0 false
      ✓ should receive response set in choice transition callback
0 undefined
0 false
0 false
0 false
      ✓ should clear response cache before run
0 undefined
0 false
      ✓ should throw error when out of choice index
      when the condition callback returns a numeric index
0 undefined
0 false
        ✓ should transition to first choice
0 undefined
0 false
        ✓ should transition to second choice
      when the condition callback returns a state name
0 undefined
0 false
        ✓ should transition to first choice
0 undefined
0 false
        ✓ should transition to second choice
    isFinal
      single final state
0 undefined
        ✓ should report if current state is final
        ✓ should report if provided state is final
      multiple final states
0 undefined
        ✓ should report if current state is final
        ✓ should report if provided state is final
    Callback prefix: 
0 undefined
      ✓ should call callbacks with custom prefix
0 undefined
      ✓ should call callbacks with no prefix

  Promise library: promise
    Initialisation
      ✓ should default to "none" state
      ✓ should initialize to provided state
      ✓ should throw error on transition with array value for 'to'
      ✓ should use the configured promise library
    Basic operations
0 undefined
0 false
0 false
0 false
      ✓ should load standalone state machine
0 undefined
0 false
0 false
0 false
      ✓ should load targeted state machine
0 undefined
      ✓ should access targeted state machine properties
0 undefined
0 false
      ✓ should indicate if can transition - can & cannot
0 undefined
0 false
      ✓ should find if state is the current state - is
0 undefined
0 false
      ✓ should throw errors on inapropriate events
0 undefined
      ✓ should call callbacks in proper order during transition events
      ✓ should call callbacks in proper order during no-transition events
0 undefined
      ✓ should call callbacks with correct arguments
0 undefined
      ✓ should call with correct arguments when sync callbacks return undefined
0 undefined
      ✓ should call with correct arguments when async callbacks return undefined
0 undefined
      ✓ should call sync callback
0 undefined
      ✓ should call async callback
0 undefined
      ✓ should call mixed sync & async callbacks
0 undefined
      ✓ should support arrow functions as callbacks
    Advanced operations
0 undefined
      ✓ should trigger event with multiple "from" states for same event
      ✓ should trigger event with multiple "from" states but no "to"
0 undefined
0 false
0 false
0 false
      ✓ should trigger event with multiple "to" states for same event
      ✓ should trigger multiple times events with no state transition
0 undefined
0 false
0 false
0 false
      ✓ should trigger appropriately with multiple "from" and "to" transitions
0 undefined
0 false
0 false
      ✓ should support spying
    Transitions
0 undefined
      ✓ should allow inter transition
      ✓ should allow nop transition
      ✓ should allow multiple nop transitions
0 undefined
      ✓ should throw error on nop when previous inter transition not completed
0 undefined
0 true
      ✓ should throw error on inter when previous inter transition not completed
1 undefined
      ✓ should throw error on inter when previous nop transition not completed
0 undefined
0 false
      ✓ should clean up failed inter transition
0 undefined
      ✓ should clean up failed noop transition
0 undefined
0 false
      ✓ should trigger new transition immediately when entered a state
0 undefined
      ✓ should trigger inter state transition after specific no-transition event
    Graceful error recovery
0 undefined
      ✓ should recover from error in sync callback and continue transition
0 undefined
      ✓ should recover from error in async callback and continue transition
    Transition lifecycle with errors
0 undefined
      ✓ should remain in "from" state when error in onleave{stateName}
0 undefined
      ✓ should remain in "from" state when error in onleave
0 undefined
      ✓ should revert to "from" state when error in on{eventName}
0 undefined
      ✓ should revert to "from" state when error in onenter{stateName}
0 undefined
      ✓ should revert to "from" state when error in onenter
0 undefined
      ✓ should move to "to" state when error in onentered{stateName}
0 undefined
      ✓ should move to "to" state when error in onentered
    Promise chain returned values
0 undefined
      ✓ should return "options" if not set
0 undefined
      ✓ should return object if "options.res" set in a callback
0 undefined
      ✓ should return last object if "options.res" set in multiple callbacks
0 undefined
      ✓ should return properties of "options" set in callbacks
0 undefined
      ✓ should return last property of "options" value updated in callbacks
    Conditional transition
      ✓ should initialize state machine
0 undefined
0 false
      ✓ should transition async to selected choice
0 undefined
0 false
      ✓ should transition from multiple states
0 undefined
0 false
      ✓ should receive original options object
0 undefined
0 false
      ✓ should receive response set in choice transition callback
0 undefined
0 false
0 false
0 false
      ✓ should clear response cache before run
0 undefined
0 false
      ✓ should throw error when out of choice index
      when the condition callback returns a numeric index
0 undefined
0 false
        ✓ should transition to first choice
0 undefined
0 false
        ✓ should transition to second choice
      when the condition callback returns a state name
0 undefined
0 false
        ✓ should transition to first choice
0 undefined
0 false
        ✓ should transition to second choice
    isFinal
      single final state
0 undefined
        ✓ should report if current state is final
        ✓ should report if provided state is final
      multiple final states
0 undefined
        ✓ should report if current state is final
        ✓ should report if provided state is final
    Callback prefix: 
0 undefined
      ✓ should call callbacks with custom prefix
0 undefined
      ✓ should call callbacks with no prefix

  Promise library: Q
    Initialisation
      ✓ should default to "none" state
      ✓ should initialize to provided state
      ✓ should throw error on transition with array value for 'to'
      ✓ should use the configured promise library
    Basic operations
0 undefined
0 false
0 false
0 false
      ✓ should load standalone state machine
0 undefined
0 false
0 false
0 false
      ✓ should load targeted state machine
0 undefined
      ✓ should access targeted state machine properties
0 undefined
0 false
      ✓ should indicate if can transition - can & cannot
0 undefined
0 false
      ✓ should find if state is the current state - is
0 undefined
0 false
      ✓ should throw errors on inapropriate events
0 undefined
      ✓ should call callbacks in proper order during transition events
      ✓ should call callbacks in proper order during no-transition events
0 undefined
      ✓ should call callbacks with correct arguments
0 undefined
      ✓ should call with correct arguments when sync callbacks return undefined
0 undefined
      ✓ should call with correct arguments when async callbacks return undefined
0 undefined
      ✓ should call sync callback
0 undefined
      ✓ should call async callback
0 undefined
      ✓ should call mixed sync & async callbacks
0 undefined
      ✓ should support arrow functions as callbacks
    Advanced operations
0 undefined
      ✓ should trigger event with multiple "from" states for same event
      ✓ should trigger event with multiple "from" states but no "to"
0 undefined
0 false
0 false
0 false
      ✓ should trigger event with multiple "to" states for same event
      ✓ should trigger multiple times events with no state transition
0 undefined
0 false
0 false
0 false
      ✓ should trigger appropriately with multiple "from" and "to" transitions
0 undefined
0 false
0 false
      ✓ should support spying
    Transitions
0 undefined
      ✓ should allow inter transition
      ✓ should allow nop transition
      ✓ should allow multiple nop transitions
0 undefined
      ✓ should throw error on nop when previous inter transition not completed
0 undefined
0 true
      ✓ should throw error on inter when previous inter transition not completed
1 undefined
      ✓ should throw error on inter when previous nop transition not completed
0 undefined
0 false
      ✓ should clean up failed inter transition
0 undefined
      ✓ should clean up failed noop transition
0 undefined
0 false
      ✓ should trigger new transition immediately when entered a state
0 undefined
      ✓ should trigger inter state transition after specific no-transition event
    Graceful error recovery
0 undefined
      ✓ should recover from error in sync callback and continue transition
0 undefined
      ✓ should recover from error in async callback and continue transition
    Transition lifecycle with errors
0 undefined
      ✓ should remain in "from" state when error in onleave{stateName}
0 undefined
      ✓ should remain in "from" state when error in onleave
0 undefined
      ✓ should revert to "from" state when error in on{eventName}
0 undefined
      ✓ should revert to "from" state when error in onenter{stateName}
0 undefined
      ✓ should revert to "from" state when error in onenter
0 undefined
      ✓ should move to "to" state when error in onentered{stateName}
0 undefined
      ✓ should move to "to" state when error in onentered
    Promise chain returned values
0 undefined
      ✓ should return "options" if not set
0 undefined
      ✓ should return object if "options.res" set in a callback
0 undefined
      ✓ should return last object if "options.res" set in multiple callbacks
0 undefined
      ✓ should return properties of "options" set in callbacks
0 undefined
      ✓ should return last property of "options" value updated in callbacks
    Conditional transition
      ✓ should initialize state machine
0 undefined
0 false
      ✓ should transition async to selected choice
0 undefined
0 false
      ✓ should transition from multiple states
0 undefined
0 false
      ✓ should receive original options object
0 undefined
0 false
      ✓ should receive response set in choice transition callback
0 undefined
0 false
0 false
0 false
      ✓ should clear response cache before run
0 undefined
0 false
      ✓ should throw error when out of choice index
      when the condition callback returns a numeric index
0 undefined
0 false
        ✓ should transition to first choice
0 undefined
0 false
        ✓ should transition to second choice
      when the condition callback returns a state name
0 undefined
0 false
        ✓ should transition to first choice
0 undefined
0 false
        ✓ should transition to second choice
    isFinal
      single final state
0 undefined
        ✓ should report if current state is final
        ✓ should report if provided state is final
      multiple final states
0 undefined
        ✓ should report if current state is final
        ✓ should report if provided state is final
    Callback prefix: 
0 undefined
      ✓ should call callbacks with custom prefix
0 undefined
      ✓ should call callbacks with no prefix

  Promise library: RSVP
    Initialisation
      ✓ should default to "none" state
      ✓ should initialize to provided state
      ✓ should throw error on transition with array value for 'to'
      ✓ should use the configured promise library
    Basic operations
0 undefined
0 false
0 false
0 false
      ✓ should load standalone state machine
0 undefined
0 false
0 false
0 false
      ✓ should load targeted state machine
0 undefined
      ✓ should access targeted state machine properties
0 undefined
0 false
      ✓ should indicate if can transition - can & cannot
0 undefined
0 false
      ✓ should find if state is the current state - is
0 undefined
0 false
      ✓ should throw errors on inapropriate events
0 undefined
      ✓ should call callbacks in proper order during transition events
      ✓ should call callbacks in proper order during no-transition events
0 undefined
      ✓ should call callbacks with correct arguments
0 undefined
      ✓ should call with correct arguments when sync callbacks return undefined
0 undefined
      ✓ should call with correct arguments when async callbacks return undefined
0 undefined
      ✓ should call sync callback
0 undefined
      ✓ should call async callback
0 undefined
      ✓ should call mixed sync & async callbacks
0 undefined
      ✓ should support arrow functions as callbacks
    Advanced operations
0 undefined
      ✓ should trigger event with multiple "from" states for same event
      ✓ should trigger event with multiple "from" states but no "to"
0 undefined
0 false
0 false
0 false
      ✓ should trigger event with multiple "to" states for same event
      ✓ should trigger multiple times events with no state transition
0 undefined
0 false
0 false
0 false
      ✓ should trigger appropriately with multiple "from" and "to" transitions
0 undefined
0 false
0 false
      ✓ should support spying
    Transitions
0 undefined
      ✓ should allow inter transition
      ✓ should allow nop transition
      ✓ should allow multiple nop transitions
0 undefined
      ✓ should throw error on nop when previous inter transition not completed
0 undefined
0 true
      ✓ should throw error on inter when previous inter transition not completed
1 undefined
      ✓ should throw error on inter when previous nop transition not completed
0 undefined
0 false
      ✓ should clean up failed inter transition
0 undefined
      ✓ should clean up failed noop transition
0 undefined
0 false
      ✓ should trigger new transition immediately when entered a state
0 undefined
      ✓ should trigger inter state transition after specific no-transition event
    Graceful error recovery
0 undefined
      ✓ should recover from error in sync callback and continue transition
0 undefined
      ✓ should recover from error in async callback and continue transition
    Transition lifecycle with errors
0 undefined
      ✓ should remain in "from" state when error in onleave{stateName}
0 undefined
      ✓ should remain in "from" state when error in onleave
0 undefined
      ✓ should revert to "from" state when error in on{eventName}
0 undefined
      ✓ should revert to "from" state when error in onenter{stateName}
0 undefined
      ✓ should revert to "from" state when error in onenter
0 undefined
      ✓ should move to "to" state when error in onentered{stateName}
0 undefined
      ✓ should move to "to" state when error in onentered
    Promise chain returned values
0 undefined
      ✓ should return "options" if not set
0 undefined
      ✓ should return object if "options.res" set in a callback
0 undefined
      ✓ should return last object if "options.res" set in multiple callbacks
0 undefined
      ✓ should return properties of "options" set in callbacks
0 undefined
      ✓ should return last property of "options" value updated in callbacks
    Conditional transition
      ✓ should initialize state machine
0 undefined
0 false
      ✓ should transition async to selected choice
0 undefined
0 false
      ✓ should transition from multiple states
0 undefined
0 false
      ✓ should receive original options object
0 undefined
0 false
      ✓ should receive response set in choice transition callback
0 undefined
0 false
0 false
0 false
      ✓ should clear response cache before run
0 undefined
0 false
      ✓ should throw error when out of choice index
      when the condition callback returns a numeric index
0 undefined
0 false
        ✓ should transition to first choice
0 undefined
0 false
        ✓ should transition to second choice
      when the condition callback returns a state name
0 undefined
0 false
        ✓ should transition to first choice
0 undefined
0 false
        ✓ should transition to second choice
    isFinal
      single final state
0 undefined
        ✓ should report if current state is final
        ✓ should report if provided state is final
      multiple final states
0 undefined
        ✓ should report if current state is final
        ✓ should report if provided state is final
    Callback prefix: 
0 undefined
      ✓ should call callbacks with custom prefix
0 undefined
      ✓ should call callbacks with no prefix

  Promise library: when
    Initialisation
      ✓ should default to "none" state
      ✓ should initialize to provided state
      ✓ should throw error on transition with array value for 'to'
      ✓ should use the configured promise library
    Basic operations
0 undefined
0 false
0 false
0 false
      ✓ should load standalone state machine
0 undefined
0 false
0 false
0 false
      ✓ should load targeted state machine
0 undefined
      ✓ should access targeted state machine properties
0 undefined
0 false
      ✓ should indicate if can transition - can & cannot
0 undefined
0 false
      ✓ should find if state is the current state - is
0 undefined
0 false
      ✓ should throw errors on inapropriate events
0 undefined
      ✓ should call callbacks in proper order during transition events
      ✓ should call callbacks in proper order during no-transition events
0 undefined
      ✓ should call callbacks with correct arguments
0 undefined
      ✓ should call with correct arguments when sync callbacks return undefined
0 undefined
      ✓ should call with correct arguments when async callbacks return undefined
0 undefined
      ✓ should call sync callback
0 undefined
      ✓ should call async callback
0 undefined
      ✓ should call mixed sync & async callbacks
0 undefined
      ✓ should support arrow functions as callbacks
    Advanced operations
0 undefined
      ✓ should trigger event with multiple "from" states for same event
      ✓ should trigger event with multiple "from" states but no "to"
0 undefined
0 false
0 false
0 false
      ✓ should trigger event with multiple "to" states for same event
      ✓ should trigger multiple times events with no state transition
0 undefined
0 false
0 false
0 false
      ✓ should trigger appropriately with multiple "from" and "to" transitions
0 undefined
0 false
0 false
      ✓ should support spying
    Transitions
0 undefined
      ✓ should allow inter transition
      ✓ should allow nop transition
      ✓ should allow multiple nop transitions
0 undefined
      ✓ should throw error on nop when previous inter transition not completed
0 undefined
0 true
      ✓ should throw error on inter when previous inter transition not completed
1 undefined
      ✓ should throw error on inter when previous nop transition not completed
0 undefined
0 false
      ✓ should clean up failed inter transition
0 undefined
      ✓ should clean up failed noop transition
0 undefined
0 false
      ✓ should trigger new transition immediately when entered a state
0 undefined
      ✓ should trigger inter state transition after specific no-transition event
    Graceful error recovery
0 undefined
      ✓ should recover from error in sync callback and continue transition
0 undefined
      ✓ should recover from error in async callback and continue transition
    Transition lifecycle with errors
0 undefined
      ✓ should remain in "from" state when error in onleave{stateName}
0 undefined
      ✓ should remain in "from" state when error in onleave
0 undefined
      ✓ should revert to "from" state when error in on{eventName}
0 undefined
      ✓ should revert to "from" state when error in onenter{stateName}
0 undefined
      ✓ should revert to "from" state when error in onenter
0 undefined
      ✓ should move to "to" state when error in onentered{stateName}
0 undefined
      ✓ should move to "to" state when error in onentered
    Promise chain returned values
0 undefined
      ✓ should return "options" if not set
0 undefined
      ✓ should return object if "options.res" set in a callback
0 undefined
      ✓ should return last object if "options.res" set in multiple callbacks
0 undefined
      ✓ should return properties of "options" set in callbacks
0 undefined
      ✓ should return last property of "options" value updated in callbacks
    Conditional transition
      ✓ should initialize state machine
0 undefined
0 false
      ✓ should transition async to selected choice
0 undefined
0 false
      ✓ should transition from multiple states
0 undefined
0 false
      ✓ should receive original options object
0 undefined
0 false
      ✓ should receive response set in choice transition callback
0 undefined
0 false
0 false
0 false
      ✓ should clear response cache before run
0 undefined
0 false
      ✓ should throw error when out of choice index
      when the condition callback returns a numeric index
0 undefined
0 false
        ✓ should transition to first choice
0 undefined
0 false
        ✓ should transition to second choice
      when the condition callback returns a state name
0 undefined
0 false
        ✓ should transition to first choice
0 undefined
0 false
        ✓ should transition to second choice
    isFinal
      single final state
0 undefined
        ✓ should report if current state is final
        ✓ should report if provided state is final
      multiple final states
0 undefined
        ✓ should report if current state is final
        ✓ should report if provided state is final
    Callback prefix: 
0 undefined
      ✓ should call callbacks with custom prefix
0 undefined
      ✓ should call callbacks with no prefix


  660 passing (747ms)

